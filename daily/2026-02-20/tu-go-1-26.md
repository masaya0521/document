# Go 1.26 — Green Tea GC デフォルト化と言語仕様の改善

- **日付**: 2026-02-20
- **カテゴリ**: Language
- **ソース**: [公式ブログ](https://go.dev/blog/go1.26), [リリースノート](https://go.dev/doc/go1.26)

## 概要

Go 1.26 は Go 1.25 から 6 ヶ月後のリリースで、2026 年 2 月中旬に公開された。最大の目玉は、実験的だった Green Tea ガベージコレクタがデフォルトで有効化されたことで、GC オーバーヘッドが 10〜40% 削減される。言語仕様では `new` 関数の拡張とジェネリック型の自己参照が追加され、ランタイムとツールチェーンにも多くの改善が含まれる。

## 主な変更点

### 言語仕様

#### `new` 関数の拡張

`new` 関数のオペランドに式を指定できるようになり、ポインタ変数の初期化が簡潔に書けるようになった。

```go
// Before: 一時変数を経由する必要があった
v := int64(300)
ptr := &v

// After: 直接初期化可能
ptr := new(int64(300))
```

#### ジェネリック型の自己参照

ジェネリック型が自身の型パラメータリスト内で自身を参照できるようになった。これにより、ツリー構造やグラフなどの再帰的なデータ構造の型定義が簡潔になる。

### ランタイム

- **Green Tea GC のデフォルト有効化**: GC オーバーヘッドを 10〜40% 削減。以前は `GOEXPERIMENT=greenteagc` でオプトインが必要だった
- **cgo オーバーヘッド約 30% 削減**: C コードとの相互運用が高速化
- **スライスのスタック割り当て最適化**: コンパイラがスライスのバッキングストアをスタック上に割り当てできるケースが増加
- **ヒープアドレスランダム化**: 64 ビットプラットフォームでセキュリティ強化
- **ゴルーチンリークプロファイル（実験的）**: デッドロック状態のゴルーチン検出が可能に

### ツール

- **`go fix` の刷新**: Go 分析フレームワークを使って完全に書き直され、数十個の「モダナイザー」を搭載。古いコードパターンを最新のスタイルに自動更新
- **`go mod init` のデフォルト Go バージョン引き下げ**: サポート対象外バージョンとの互換性を促進
- **`cmd/doc` と `go tool doc` の削除**: `go doc` コマンドに統一
- **pprof ツール**: Web UI（`-http` フラグ）がデフォルトでフレームグラフビューを表示

### 新しい標準ライブラリパッケージ

- **`crypto/hpke`**: RFC 9180 準拠のハイブリッド公開鍵暗号（HPKE）。ポスト量子ハイブリッド KEM もサポート
- **`crypto/mlkem/mlkemtest`**: ML-KEM（ポスト量子暗号）のテストユーティリティ
- **`testing/cryptotest`**: 暗号テスト向けユーティリティ
- **`runtime/secret`（実験的）**: 秘密情報処理向けのセキュアな一時削除機能

### 実験的機能

- **`simd/archsimd`**: `GOEXPERIMENT=simd` で有効化。アーキテクチャ固有の SIMD 操作へのアクセスを提供

### 非推奨化

- 暗号関数の `random` パラメータが無視されるようになり、常に安全な暗号乱数源が使用される
- テスト用に `testing/cryptotest.SetGlobalRandom` 関数が提供

## 今後の注目点

- Green Tea GC の実環境での安定性とパフォーマンス影響のフィードバック
- `simd/archsimd` パッケージの正式化に向けた進展
- ゴルーチンリークプロファイルの正式サポート化
- Go 1.27（2026 年 8 月頃予定）での追加改善
